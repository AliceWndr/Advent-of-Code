SantaRoute="vvvv<vvvv><<^^<^v>>^^^^^<vv^^<><^vv^^<v>^>^^v^v>^^<>>>v>^v^>><^^^<vv^><><><^^>v>>><^>^v>>^^^^^>>^^v><>>^^<<>>><^>v>^<><v><^^^^>v<^>^vv^^<>^^^^vv<>^<v^>^^v>><<vvvv^<><v><v>v>v^^vv^^>v<^v^v>>v<>v<^^<<<<<<^>>v^v<v<<<^^v<^>^^v>>vv><^>v^vvvv>v>vvvv>^^><vv^v^>^<<^v^^v>>^^>^<^^>>v<^>^>v^<^>v>^^>v<^v^^<<<<^v>v^>^<><<^v<<v^<v^^<<^>^^^v^^>^v^v<^^^<><v^<<<^v<^>^^<>^>><<>^^>v^<v^^^^v>>^^vvv>>>^^<v<v^>>v^><<^^^<^v>^v^v<v<>^vv>>><><v>>vv>^>>>vv^><>><vv<>v<<^v^>^<v^v><vv>v<^>^v<^v>^v<v><<v<<^<v<<>>v^>v^<vvv<>v>>>^vv>v>>^><vv^>^>vvv^^v^>v<<>^vv>v<>vv<v<>v>>vv<<v>v<>^<v^v^<v^v<<<<>^^<^>v^>><^v<v<^<^<vv>>^>vv^v>><>>^><<<vv><^<^v<><><<<^><vvv<<<>><<>^vv^v><>v>>>vvv^>v<<^<<<>^<<<v^<<<^<>>>v>>^>v<v^>>v<vv^v^<v^>^^v^^^<><>v><<vv<>v^^<v^><<v<^^^vv<v^<>^v>>v>^<>v<^<v<<v>^>^<>v>^>>v<v>>><<><^^v<^v^>><vv^<vv><>>^^<<vv<>><<vv>^v>v^<<>^<>>^<^<v>>v^^v>vv><<>v>><^<<>^v><v>^^^>^vvv><>v^v^v><><v^vv<<<<v^>v^^v>^^^<<<>>vv><><<^^>>^^<<v>>vvv>^<vv<>v>^>^<<><>^>v>vv>^^^^^vv>^vv><vv<^^^v^>^<^^^>vvv<<>><>>^v<<^<^><<^^<>v>^<><<>v>>^v><>>><<><>vvv>v<>vv>^v<^vv<<>>vv<<<>v<v^>v^v><^vvv><<>^>^v><v>v<>^^v^><<>^<^<>v^><v><^<>>>vv<^v><^<v^<<vv^vvv>v>v>^^>v^v<^vv<>^>^>><<v>><v<^>vv^v^^vvv<^v>>^^<>><^>v^>v>>>>><<vvv>v^v^<^<^^<>v^^^^>vv^v>vv^v><<^>^<v<<<^^<^>vv^>^^<v<>v<vvvvv^^<vv>v><^>^v<<><<<<>>>vvv>^^^v^<>^<v<<vv<<<<<v<<v>^^^>vv>^<><><<^v<<<vv>^v<><<>^v>v>vvvvv<><><<v^><>>>^><><v^<>><>>^v>v<>v>><^<vv^^vvv>v^v<vv^<vv<v>^^^>><<<^v^>><<^^^>v^<<^^vv<^^><<vvv^^>>><^>>v^v<^^^vv><<<<<v<^>vv<v<v>^<>>>v>v<vv><><>v>v><<<v<vv<vvv<^v^>^vv<v<^^^>^<v><>>><<vv^v<^v^vvv>>^v><vv<<>vvv<><^v><^><^vv<v<^<<><v>><<<v<<>^<^v<v>v><^^<^^vv^v>vvv>vv>^v^<v^>^vv>^vv<vvv^>v^v^<^^v<<^>^<^<^v>^^<^^^><vv<<<^>>^<^^v^^^^^^vv<^><>>v>>^>^<<^<<v<>^<^>vv<v^><><v<<^>><v^v^<v<^^^v<<<^<^v><<>^<<v^v^^vvvvv>^<<^^v<v<^<<<v>vv<v>^^^^<^v^^vv>^<<v^v>>><v^>v^<v<^>v>>^v^^vv>><>><>>^<v>^vvv^^^^<>>v><v^<>v<v^^>>^v^^><^vv^>>>><<v><<^>><^<<v>v<<^<<v^<>>>><v^^>v>^<v<vvv>^vv<>v^><>^v<^^<vvvv<<>^^<vvv^<^<<v^v>vv^<<>>>v<^v^><vv<vv><<>^^>vv<><>^>>v^v<<<v<<>^vvv^^>v>^v^v^><^v>^>^<<vvv>^><^<<^<v><^v><v^v>v>><<^^><^^^>^v^^v^<>^v<^>v>^<<^v>v^>v^^vvv>>^>>^vv^v<<<>><^v<^v><<>^<^><v^>vv^<<v^v^<>>^v>><vv^^<^><^vv^^>>v^v^v^><^^>><^<vv^<^v<v<^^v>vv<v<v<vv>vvv^<^<^<<v>v<>^>v^^<^>^>^>vvv^v<<^^v><v^^vv^vvv^v<vv<><v^v<vvv>v^>><^^v>v^^v^v><<<<v>><^^v^<<>><^v^vv^^^>>vv^>^v><>^<<<>v^<<>^<v^v<v<^>>^^>>vv^><v^>>v<<<^<^vvvv>vv<<<^>^<>^<><v<>><vv<v<v^>>>^^v>^<><^<<^<<<vvv>v><<>v>>^v>^v^<<^<^<>vv><><v^<>^<><^^>v<v<<<^<^^<v>^<<<>^vv^^<^<>v<<^<<>^<>><v>v^><v^v<<^>^><<vv<>v^><v>><v>^>v^v<^^v><><>v^v>^^vv>^>^^<>^><>>^v^<<>^<vv^^^>^><^^<vv^v^v^vv><v^^^v<<<vvv^vvv<v>^<<<v<>>^<^<^<^<^^>>v<^>>^^><^v^vvv>^^^^v^<^v^v>^>>>v^^>v^v>v^><<^<>>>>v>v^<v>^^^<^>^<^<v^>^>^>^<vv<^^^v^>^vv<>v>vv>v>>^<>v>v^^>v<v^>^v>>v>v^<v<>^>^<^v^^<^><><^^<<vv^>^^<>v>^^v><^>^v^^>^<v>v>vv<^v^><vv<^>^v^<<v<vv>v<>>v^^v<v<^<>><vv^^>v>^<>><<<v>^>>v>>><^<v>>^^^<>^<^><<><<^^v><<>v>>^^>v<^v><^>vv^^<^vvv^^vv<^v>><>^v>^<>>v^^^v><<^vv<<<v^<><^v>>><v<vv<<v^^>^><v<vv^>v<><<^<>^^^^v><>v>^>^^^^<^>>^^^<<v>v>v^v<v^^<<^><>^^<^><<><^>v<^^v<^v>>^^>>vvv>>^^<<^^<v>>^<><v^^>^>v>>>v<<^v>^><<^<>^<^>v>>>>^^>v<<^>^v>^v^>>v<<>v>^<>v<<vv>v^v<<>^<<v<>v<<^^>v^<v<<>^>v^v>^><<v>v^^><v^vvvvv>><<vv<v^^>><>v<>^v<^vvv<>><<^^v>v<>>v<v>^v^vv><v<<^><<<v^v><v^v<<vv<<>>^^^><^^<<^>^>vv^vv^<<<vv<vv>>^v<<^v<^^>v^<v<><^^v<^<<>^<<v<<v<^<^v>>v<^>v^><<^^^^^>v<>^v<v>vvvvv<<>>vvvv^>^<<>^><vv>vvv^>><>^v^v>>>v<<<v>^>vvvv^vv>v<><<><<><>>v<<^^<<v^<^>><><<<>^<>^>v>^<^<v^vv<>^>>><^v<<>^<v>^><v<<v<<^>v><^<<v<<>v>><^^><v<<v^>v><>^v><<><^<>^<>v<<><<^v<vvv<<<^>v><^v><>^>>v><^^^^>v>vvv^>>>^<<vv>^><<<^<<<^>^>v>><vvv^<><v^>^^<<>><>><><><v^>^vv<<^vv^v<>vv<<<>>>v>><vv^<<v^<<^v>><^><>>v><>^><^^^>^<>vv^<^<>v<v><<>>>v^^><<^>^^v>>>^^>v<v<vv>v^<v<^<v<^vvv>^>v>^<^>^^^<<<^^v<v<^^v<<v>^vv^<v^><>v<><^^^<v^v<>^v>v>^><v^><<><><<^^>^><<vvvv^^>>vv<^<>v>^vvvv>>v^<<<>v^<vv>vv<<<>v>^^>vvvv<^v^><^<>^<<<v>v>^v^<^v^>v<<<^>>v^^^<>^v^><<<^>^><v^v>>^vv<v>^vv<<>vv^vvvv<>vvvv>v>^<>v^<v>^^vv><v>>>>v><<vv^>v><>v<v^^>>>><<<<v^<v^>>>>><v^^v^^^<v<v>^v<^^><<>v^<^<>><^<^^><>>v>^<><<<>^^vv<^<><^>^v^<^>>v><^^v>v^><<<<v<><<<^>^^><<^<>^>>v>>v>^vv<>^v>v^<<<^^<v^>v^^v<>v^>>>>>v><^><>"
RoboRoute="><v<v^<>vv<^^^<<v^v>>>>>vv<><^<<vv>>>^^<<^>vv<v>>^><^vv>v><<^v>>>v^v><^<v>><>vvv>v<<<<<v^v^<v^><>><^>^^v>vv><vvv^<>>v^>^^>v^v^>v<^<<v>>^^>^^v<>v>vv^^<<<v^<>>>>v^v^<<vv<^^<<vv<>vv>>^^vv<^<vv^><<<v<>v^^>^^^>>>^>>^^v>^v^<vvv<>>^<>^vv^>^><v>><^^>v^>v<v^^v<v<<vv>v^<^vv^><^v<>v<vv^^v>^^^v^><<<><^v>^v^^vv^v^v>v>v><>v^^>^<<<>>>v^>^<v<^><^>^^vv>^v^^<<<^v>^^<^>><>v<>^v<^>v>>v>^^vvv<<<>>^^^<<<>><v<><^^v^<>v><vv<v<^v><^>><>vv>^^>v<>><>>vv<>v<^<^^v^vvv<v>^^^^vv><^>>><^>>v>^<<<<<<^><^<<^v^>>v<<^>^>vv>v>><>^>>^^<<^^^<<<^^vv^<^^v^^>v^^v<^^><<>>v<v>vvv>>^^^>^^<v<<<>>v<>^v>>>>><<<^^v<^>vv<<>>^<v>^v^>v>^>vv<^<>^<v<v^v<<>^^>^><><<>v<>^<<v^^>>vvv<^v^<v<vv>><v<<vv>^v^>>^^<^<>vv<v<><^>vv^v^v><^^>^<>^^>^v^<>>>>>^<^v^v<><><^^>><vv><<<vvvv<<^v>vvv>>^vv>^<<v<>^^^><^^^><v^>>>v><vv<>v<>>>^v<><^>^v>v>^>^^^<<^^vvvv^v>>^vv>^<<v><^<<^^^<<^<^^<>v<<^vv><<v><<vvvv^<^v>v<v>^>>vvv>vv^^<vv>^vv<v^v<<v>><v^^vv^v^>v<^^<^^v^v^>v^^^v^>v<v><v<v<<v^<^>^v<<<>>v>v><<^<<<^><^vvv^>^><vv<^<<v^^<v^v<<vv^>><vv<^v^<v<^<<^<>^>>v^><<^<v<^<^><>vv^v^^<^v^^^<v^v^^<v<vv<v<>^>v^^v^>>^>^><v^vv>vv>>>^v<vvv^^>^^v>>^<^^<v^<>>^^v>v^^v^>>vv>^v<>^><>^<<>^<^><v^>^>^<vv^vvvv<><^v<<>vv>^<v<<v^><^v>vvv><<<^vv^v>^>><><^>^^v>vvv<>^^v<<>v^><^<v^^>^<^v><<<<<^<^<>^vv>^^^v^^><v^>>^^<><<>v<<>^>^>>>>vv>>^><vv<v>v<<^^^>>^<vv>><<><<>>^^v^<<^<v^>>vv><^<<<><><>><>><^><<<>v^<>^^<^<^<><<^v<><^<<v>^^v<>v><><>>^<vvv<v>^><>v<>>>><<>>vv^^^><><^^v^v><>vv><>v<<v^<>>vv<<>^v>v^^vv>v>>v>><>><<^v^<>v^^>>^vv>^<>>><<^v<^v>>^^>vvv>^>v^<^vv<vvv^^^<^^vvv^<<^><>v<^<>v^v<v<>v^v<>^v<^<^<<^<><<v^<^><<^>v><<<v>vv<^<>^^>>><<>v>>v^<><>>^^v<<v<v<><v>>v<<v>>vv^<v^v<>v^>v^>^v>^<<<><>^<<><^>>^^v^<v<>^^>><<^><^vv^^v<><>^<v^<>^>^>^>vv^<<v<v^^^>v><>>>v<^<v<>^>vv^^^>>v^<^vv^<<^<^v<<>^<^<<>>v<>><>v<^^^<<v<<<v^>><^^>^^v>vv><>^><<v<>^>>^^v>v<<<>>>^>>><^>><^v^v^<v^>><>^>>><<^>>>>v^vvv<^><<^^<<><v><^<><<<^<<<v>><>^>>v<vv><<>^v<v<^>>^<><<v>^><v^<<^<>>^v>^><^^v^<><><^<v^vv><>^vvv><<^<<^v^^^<v^>^^^v>><vv^>v><^<>^>>vv>>^v^^<<v<<v^>^>^v><v>^>>>><>^>^>>>vv<<^v<>^^^^v<<<^<>^<^v<<^v^>><>vv^^v<^>v^v<vv<v^>v<>v<>v<>>^v<^<^v<>v<^>><<^<v^^<<^>^>^^^^<^v<v^<><<>>><>^^^^v<^>>>>v^^<v^<^<v<v>^^<^<>^^^<<vv<v<<>>>v><>>vvvv<<><^v<^^v^><^>>>^<v^^>vv<^>>><v>>v<>>>^^^v><v>^v>^>>v>^><<^^<v>vv<><>^>v^<vv><v><><<^<<<vv><v<><<><<>>v^><^v<v^v>>v><><vv>>^><<>v><>^><v<v<v<<>>^^^><^>vvvv>v>><>v<v>v>^<vv>>><^v>>^>vv>>><^^<>><><vv>^vv<<<<>v^^vv<<vv^><<><^<>v><<^^>vv^^^v^<>^>^>v<^^v>v<^<>v>v>v>><v>>^v^<<v^<<^<vv^^^v^>vv><<v^>>v<v<>>>vvv>><><<<<v<^v^<v^<^>vv<><^^<^v>^^v<^<v^<vv^^^>><v^>^<<>>^<<^v>>>v>>>v>>><^<>^v^<>v<^><<>vv<v>v^><<><>vvv<^>><^^<^vvvv^<<^vv><^<>^vv^>v<^^><v><>v<^<<^<v>v<vv<v^v>^^<^^<v^vvv^^^v^><^^<v<<>vv>^<^v<^vv>v<^<<v<<vv<v>^<^vv>><<v^^<^<><>>v^v^><<v>vv^vv<<<^^<^^v<<^>>v<><<v^>v^<>^^v^v^>^<><>vv^v<^><>>vvv>>^<<^vvv^^^>><^^v>^^^vv<<<^<v^>v>vv<>>>><>^^<<<<^<<v^^>v>vvv>vv<v<v>vvv><^^<>>^>v<vv^>v<<>^<<><v^>^^<>v^^<<<v>>^<^^^^^^><>v<^^<>>v><>>^<^<v>v^>><>v^v<v>^^<^^v><>^>^<><<v^<^v>^vv<^<>v^^>>v<><v<>>^<v^^>vv^v<<v>>vv<><^vv^^^<v^<^<^^>>^>^<v<<<<^<<v^vv^<v<v^>^^><v^>^<^v>>^<v^v^<vv^>^^<<<^<<><vv^<><v><^<>>v><>vvv^<><>>^^>^<^^<<vvv<>>><>v<<>^v<><v<><vv>><<v<v<^<<v<>>^^<>^><^<vv>v>^><^^<<>vvvv^^>v^<vvv^v^<<v^^v^^^>><^><<>v<v>v>^<<^><<v><<>vvv^<>^<^<^<>vv<>^^^>^vv^<<>v^<^^>^<^v^^<^>>v><>v>>vv<><>^>^<<^^v<<<<<<v<^v<<<^<^v<<<><>>v>v^v>^^^^<^^>vvvv^v>^^<v^>v<><>^v<^>>>><^>^^>v^vv>^^<<<<>v<<^^v^v^^><<>^>v>><<v<v^>^^^>^^^vvv<v<<^><v>v>^v^v><<<v^><^^^<^^^v>>v^><^>^^^^^>^^><^>vv^><><v^^v<<<^<^v<^>vvv<<v<^v>v>v<v^>>>^^^>>><<^v>^>>^>>^^<v<vv^v<<>^<^v^^<>^<v>>>>v^^>^^>vv>vv>>>>><^<^<>v>><v^<^^^^^^<vv^<>^v^^<<<>v<^<v>><>^>v>^<>>^^^^<v^^<>>><<>^^>vv<<v^v>^v><<v^<>>>><>>^<<><^v>v<<^vvv<>>v<<^^>v<v^^<^<^^><><>^><<><^><<^^v><>vv<vv^^^vv<v<^<>>v<vv^>v><^^><^<v><>vvv<v>>>^><^vv^<vv<>^^^<<>^><^^<v<^<v^<^v>vv^v^<>^^<>><v<^<vv^vv>>v^><<v>>>><<<^<>^<>^<^>v^v<>>><<><>^v><^<<<<<<v>>>v^vv^^<>v<<v>><<><v<<^<><<v>v<v>>v^>>^>^^^<v>^><v>>^^^v^vv<>^<v^<^>^><<^^v^vv<v^v^v<<>>v><^^v^^>^>vv<><v>vvv>>^^vv^><>v^^>vv^>>^^<^^vv>>><><>^vv^<^>><<^v><>>^vv>>v^^v>v><v<<v<><>v<>vv>><>^<>^v<v<^^>^^^<><>^^><v>>v>><^<^vv>v^^<>vv<^v^><v<v<v>^<v<vv^<<^vv^<>^^vv^>vv<v<>^^<^v^^v><v^v>^<<^^^<^<>v<>^<<v><^v^<>>"
FullRoute=nchar(SantaRoute)+nchar(RoboRoute)

day3_dupl_delivery <- function(str,fullLen){
  moves=fullLen
  field=matrix(data=0,moves+1,moves+1)
  field[ceiling(moves/2)+1,ceiling(moves/2)+1]=1 #first package
  #starting coordinates
  curr_x=ceiling(moves/2)+1
  curr_y=ceiling(moves/2)+1
  
  for(move in 1:nchar(str)) { #looping through each move
    if(substr(str,move,move)=="v"){
      field[curr_x+1,curr_y]=field[curr_x+1,curr_y]+1
      curr_x=curr_x+1
    } else if(substr(str,move,move)=="^"){
      field[curr_x-1,curr_y]=field[curr_x-1,curr_y]+1
      curr_x=curr_x-1
    } else if(substr(str,move,move)==">"){
      field[curr_x,curr_y+1]=field[curr_x,curr_y+1]+1
      curr_y=curr_y+1
    } else {
      field[curr_x,curr_y-1]=field[curr_x,curr_y-1]+1
      curr_y=curr_y-1
    }
  }
  
  return(field)
}


#From Console
> SantaGifts <- day3_dupl_delivery(SantaRoute,FullRoute)
> RoboGifts <- day3_dupl_delivery(RoboRoute,FullRoute)
> GiftField <- SantaGifts+RoboGifts
> length(GiftField[GiftField>0])
